<!doctype html><html lang=zh-cn itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>酷码熊博客</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=MobileOptimized content="width"><meta name=HandheldFriendly content="true"><meta name=applicable-device content="pc,mobile"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=mobile-web-app-capable content="yes"><meta name=author content="axiong"><meta name=description content="个人开发日志"><meta name=keywords content="kumaxiong,隐逸山林,阿熊,python,javascript,golang"><meta name=generator content="Hugo 0.76.5"><link rel=canonical href=https://www.kumaxiong.com/><link href=/index.xml rel=alternate type=application/rss+xml title=酷码熊博客><link rel=icon href=/favicon.ico><link rel=stylesheet href=/sass/jane.min.fa3d941d1d0e0ddc985804227feabffea55c89883eb0af34e0532a7ae9135151.css integrity="sha256-+j2UHR0ODdyYWAQif+q//qVciYg+sK804FMqeukTUVE=" media=screen crossorigin=anonymous><link rel=stylesheet href=/css/syntax.css><meta property="og:title" content="酷码熊博客"><meta property="og:description" content="个人开发日志"><meta property="og:type" content="website"><meta property="og:url" content="/"><meta property="og:updated_time" content="2020-10-16T13:22:12+08:00"><meta itemprop=name content="酷码熊博客"><meta itemprop=description content="个人开发日志"><meta name=twitter:card content="summary"><meta name=twitter:title content="酷码熊博客"><meta name=twitter:description content="个人开发日志"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>酷码熊日志</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><li class=mobile-menu-item><a class=menu-item-link href=/>首页</a></li><li class=mobile-menu-item><a class=menu-item-link href=/post/>归档</a></li><li class=mobile-menu-item><a class=menu-item-link href=/tags/>标签</a></li><li class=mobile-menu-item><a class=menu-item-link href=/categories/>分类</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://github.com/nickfan rel=noopener target=_blank>Github
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92.0.0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"/><path d="M841.152 457.152c-30.528.0-54.784 24.512-54.784 54.656V786.56H237.696V237.696h206.016c6.656.0 10.752.0 13.248.0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128H183.04C153.216 128 128 152.576 128 182.848c0 3.136.256 6.272.768 9.28C128.256 195.136 128 198.272 128 201.408v639.488c0 .064.0.192.0.256.0.128.0.192.0.32.0 30.528 24.512 54.784 54.784 54.784H829.76c6.592.0 9.728.0 11.712.0 28.736.0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344v-20.352V561.408 512.128C896 481.792 871.424 457.152 841.152 457.152z"/></svg></i></a></li><li class=mobile-menu-item><a class=menu-item-link href=/about/>关于</a></li></ul></nav><link rel=stylesheet href=/lib/photoswipe/photoswipe.min.css><link rel=stylesheet href=/lib/photoswipe/default-skin/default-skin.min.css><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header id=header class="header container"><div class=logo-wrapper><a href=/ class=logo>酷码熊日志</a></div><nav class=site-navbar><ul id=menu class=menu><li class="menu-item active"><a class=menu-item-link href=/>首页</a></li><li class=menu-item><a class=menu-item-link href=/post/>归档</a></li><li class=menu-item><a class=menu-item-link href=/tags/>标签</a></li><li class=menu-item><a class=menu-item-link href=/categories/>分类</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/nickfan rel=noopener target=_blank>Github
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92.0.0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"/><path d="M841.152 457.152c-30.528.0-54.784 24.512-54.784 54.656V786.56H237.696V237.696h206.016c6.656.0 10.752.0 13.248.0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128H183.04C153.216 128 128 152.576 128 182.848c0 3.136.256 6.272.768 9.28C128.256 195.136 128 198.272 128 201.408v639.488c0 .064.0.192.0.256.0.128.0.192.0.32.0 30.528 24.512 54.784 54.784 54.784H829.76c6.592.0 9.728.0 11.712.0 28.736.0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344v-20.352V561.408 512.128C896 481.792 871.424 457.152 841.152 457.152z"/></svg></i></a></li><li class=menu-item><a class=menu-item-link href=/about/>关于</a></li></ul></nav></header><div id=mobile-panel><main id=main class="main bg-llight"><div class=content-wrapper><div id=content class="content container"><section id=posts class=posts><article class="post bg-white"><header class=post-header><h1 class=post-title><a class=post-link href=/post/win10-dev-env-setup-2020/>win10下基础开发环境搭建2020</a></h1><div class=post-meta><time datetime=2020-10-16 class=post-time>2020-10-16</time><div class=post-category><a href=/categories/%E5%BC%80%E5%8F%91/>开发</a>
<a href=/categories/%E9%85%8D%E7%BD%AE/>配置</a></div></div></header><div class=post-content><div class=post-summary><p><strong>目前win10系统对wsl的支持在逐步提升，mac已经转型消费向的arm阵营了，也许从远期来看是对的方向，但当下的开发还是以桌面工作环境为主，所以目前而言还是配一下桌面开发环境，做一下笔记</strong></p><h2 id=参考笔记>参考笔记</h2><p><a href=https://www.lagou.com/lgeduarticle/85437.html>https://www.lagou.com/lgeduarticle/85437.html</a></p><p><a href=https://zhuanlan.zhihu.com/p/145488247>https://zhuanlan.zhihu.com/p/145488247</a></p><p><a href=https://www.sitepoint.com/wsl2/>https://www.sitepoint.com/wsl2/</a></p><h2 id=预备>预备</h2><p>win+x快捷键，选Y系统，在设备规格中选“重命名这台电脑”，可以配置个简单点的名字尽量英文小写字母后面配hosts的时候也简单点</p><h2 id=安装>安装</h2><h3 id=升级win10到最新版本>升级win10到最新版本</h3><p>家庭版和专业版都可以，有的企业版本貌似没有microsoft store商店，所以不推荐</p><ol><li>访问：https://support.microsoft.com/zh-cn/help/3159635/windows-10-update-assistant 下载更新助手（windows易升）
或者直接访问 <a href=https://www.microsoft.com/zh-cn/software-download/windows10>https://www.microsoft.com/zh-cn/software-download/windows10</a> 点立即更新
升级安装时间主要看你的机器性能及网络带宽</li></ol><h3 id=安装配置好你的网络访问工具>安装配置好你的网络访问工具</h3><p>比如clash,v2等等解决网络访问慢和阻塞的问题，此处不可描述n字省略。</p><h3 id=安装windows-terminal>安装windows terminal</h3><p>在开始菜单找到microsoft store商店进入后搜索并安装 windows terminal</p><h3 id=安装wsl2>安装WSL2</h3><p>参考：https://docs.microsoft.com/zh-cn/windows/wsl/install-win10</p><p>右键选择以管理员身份运行windows terminal，打开默认的Windows PowerShell
粘贴安装指令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>dism</span><span class=p>.</span><span class=n>exe</span> <span class=p>/</span><span class=n>online</span> <span class=p>/</span><span class=nb>enable-feature</span> <span class=p>/</span><span class=n>featurename</span><span class=err>:</span><span class=n>Microsoft-Windows-Subsystem-Linux</span> <span class=p>/</span><span class=n>all</span> <span class=p>/</span><span class=n>norestart</span>
<span class=n>dism</span><span class=p>.</span><span class=n>exe</span> <span class=p>/</span><span class=n>online</span> <span class=p>/</span><span class=nb>enable-feature</span> <span class=p>/</span><span class=n>featurename</span><span class=err>:</span><span class=n>VirtualMachinePlatform</span> <span class=p>/</span><span class=n>all</span> <span class=p>/</span><span class=n>norestart</span>
</code></pre></td></tr></table></div></div><p>运行完毕后重启系统
按照步骤4中下载并更新linux内核包
参考：
<a href=https://aka.ms/wsl2kernel>https://aka.ms/wsl2kernel</a></p><p>比如下载安装包为：</p><p><a href=https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi>https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi</a></p><p>右键选择以管理员身份运行windows terminal，打开默认的Windows PowerShell
粘贴配置指令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>wsl</span> <span class=p>-</span><span class=n>-set-default-version</span> <span class=n>2</span>
</code></pre></td></tr></table></div></div><p>安装对应的linux发行版，此次以ubuntu1804为例子
<a href="https://www.microsoft.com/zh-hk/p/ubuntu-1804-lts/9n9tngvndl3q?rtc=1&activetab=pivot:overviewtab">https://www.microsoft.com/zh-hk/p/ubuntu-1804-lts/9n9tngvndl3q?rtc=1&activetab=pivot:overviewtab</a></p><p>安装完成后创建初始用户（比如www）并设置密码则安装完毕</p><p>通过终端运行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>wsl</span> <span class=n>-l</span> <span class=n>-v</span>
</code></pre></td></tr></table></div></div><p>可以确认当前的发行版所使用的wsl的版本是2还是1</p><p><strong>如果上一个步骤中配置后忘记了初始用户的密码可以通过命令行处理一下</strong>
参考：https://winaero.com/reset-password-wsl-linux-distro-windows-10/</p><p>先设置默认登陆用户到root，此处以ubuntu18.04发行版为例子
右键选择以管理员身份运行windows terminal，打开默认的Windows PowerShell
粘贴配置指令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>ubuntu1804</span> <span class=n>config</span> <span class=p>-</span><span class=n>-default-user</span> <span class=n>root</span>
</code></pre></td></tr></table></div></div><p>以root身份打开ubuntu18.04的终端修改www用户密码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>passwd www
</code></pre></td></tr></table></div></div><p>输入新密码后，再把默认用户切回来
右键选择以管理员身份运行windows terminal，打开默认的Windows PowerShell
粘贴配置指令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>ubuntu1804</span> <span class=n>config</span> <span class=p>-</span><span class=n>-default-user</span> <span class=n>www</span>
</code></pre></td></tr></table></div></div><p>现在用刚更新后的密码登录即可。</p><h3 id=安装包管理工具>安装包管理工具</h3><ol><li>基础包安装工具</li></ol><p>右键选择以管理员身份运行windows terminal，打开默认的Windows PowerShell
运行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=nb>Install-PackageProvider</span> <span class=n>-Name</span> <span class=n>NuGet</span> <span class=n>-Force</span>
<span class=nb>Install-Module</span> <span class=n>-Name</span> <span class=n>PowerShellGet</span> <span class=n>-Force</span>
<span class=nb>Update-Module</span> <span class=n>-Name</span> <span class=n>PowerShellGet</span>
<span class=n>Exit</span>
</code></pre></td></tr></table></div></div><ol start=2><li>官方基础命令行包管理工具winget（类似于apt/yum等发行版的包管理器）</li></ol><p>网站：https://github.com/microsoft/winget-cli
下载：https://github.com/microsoft/winget-cli/releases
找最新版本的下载后执行（比如）：https://github.com/microsoft/winget-cli/releases/download/v.0.2.2521-preview/Microsoft.DesktopAppInstaller_8wekyb3d8bbwe.appxbundle</p><ol start=3><li>安装三方chocolatey包管理工具（全局-管理员）</li></ol><p>网站：https://chocolatey.org
安装参考：https://chocolatey.org/install#individual</p><p>右键选择以管理员身份运行windows terminal，打开默认的Windows PowerShell
粘贴安装指令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=nb>Set-ExecutionPolicy</span> <span class=n>Bypass</span> <span class=n>-Scope</span> <span class=k>Process</span> <span class=n>-Force</span><span class=p>;</span> <span class=no>[System.Net.ServicePointManager]</span><span class=p>::</span><span class=n>SecurityProtocol</span> <span class=p>=</span> <span class=no>[System.Net.ServicePointManager]</span><span class=p>::</span><span class=n>SecurityProtocol</span> <span class=o>-bor</span> <span class=n>3072</span><span class=p>;</span> <span class=nb>iex </span><span class=p>((</span><span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>WebClient</span><span class=p>).</span><span class=n>DownloadString</span><span class=p>(</span><span class=s1>&#39;https://chocolatey.org/install.ps1&#39;</span><span class=p>))</span>
</code></pre></td></tr></table></div></div><ol start=4><li>安装三方scoop包管理工具（当前用户）</li></ol><p>网站：https://scoop.sh/</p><p>直接运行windows terminal（以非管理员身份） 打开默认的Windows PowerShell
粘贴安装指令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=nb>Invoke-Expression</span> <span class=p>(</span><span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>WebClient</span><span class=p>).</span><span class=n>DownloadString</span><span class=p>(</span><span class=s1>&#39;https://get.scoop.sh&#39;</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>或者</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=nb>iwr </span><span class=n>-useb</span> <span class=n>get</span><span class=p>.</span><span class=n>scoop</span><span class=p>.</span><span class=n>sh</span> <span class=p>|</span> <span class=nb>iex
</span></code></pre></td></tr></table></div></div><p>如果运行出现权限异常则执行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=nb>Set-ExecutionPolicy</span> <span class=n>RemoteSigned</span> <span class=n>-scope</span> <span class=n>CurrentUser</span>
</code></pre></td></tr></table></div></div><p>后重新运行上面的安装指令</p><h3 id=升级安装最新的powershell>升级安装最新的PowerShell</h3><p>网站：https://github.com/PowerShell/PowerShell</p><p>直接运行windows terminal（以非管理员身份） 打开默认的Windows PowerShell</p><p>用winget下载安装：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>winget</span> <span class=n>install</span> <span class=n>-i</span> <span class=n>powershell</span>
</code></pre></td></tr></table></div></div><p>其中的<code>-i</code>参数可以在部分有安装选项的软件中提供安装过程中的交互，如果都按照默认值安装则可以直接不带-i参数执行默认的静默模式安装</p><h3 id=通过winget安装相关基础软件>通过winget安装相关基础软件</h3><p>wox 启动器(类似于macos下的Alfred)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>winget</span> <span class=n>install</span> <span class=n>-i</span> <span class=n>wox</span>
</code></pre></td></tr></table></div></div><p>notepad++文本编辑器</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>winget</span> <span class=n>install</span> <span class=n>-i</span> <span class=n>notepad</span><span class=p>++</span>
</code></pre></td></tr></table></div></div><p>vscode代码编辑器</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>winget</span> <span class=n>install</span> <span class=n>-i</span> <span class=n>vscode</span>
</code></pre></td></tr></table></div></div><p>Microsoft Edge 浏览器</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>winget</span> <span class=n>install</span> <span class=n>-i</span> <span class=s2>&#34;Microsoft Edge&#34;</span>
</code></pre></td></tr></table></div></div><p>git源码管理工具</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>winget</span> <span class=n>install</span> <span class=n>-i</span> <span class=n>git</span>
</code></pre></td></tr></table></div></div><h3 id=配置windows-terminal>配置windows terminal</h3><p><strong>支持sudo(管理员身份运行)</strong></p><p>使用psutils脚本
参考：https://github.com/lukesampson/psutils
直接运行windows terminal（以非管理员身份） 打开默认的Windows PowerShell</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>scoop</span> <span class=n>install</span> <span class=n>psutils</span>
</code></pre></td></tr></table></div></div><p>使用gsudo工具
网站：https://github.com/gerardog/gsudo</p><p>右键选择以管理员身份运行windows terminal，打开默认的Windows PowerShell
运行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>PowerShell</span> <span class=n>-Command</span> <span class=s2>&#34;Set-ExecutionPolicy RemoteSigned -scope Process; iwr -useb https://raw.githubusercontent.com/gerardog/gsudo/master/installgsudo.ps1 | iex&#34;</span>
</code></pre></td></tr></table></div></div><p>或者用前面的chocolatey包管理工具来安装：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>choco</span> <span class=n>install</span> <span class=n>gsudo</span>
<span class=n>refreshenv</span>
</code></pre></td></tr></table></div></div><p><strong>配置支持管理员身份运行的windows terminal选项</strong></p><p>参考：https://blog.csdn.net/weixin_39858881/article/details/107026065</p><p>在windows terminal的右上方的下拉菜单中选择设置然后编辑settings.json文件</p><p>其中powershell的图标<code>"C:\\opt\\data\\assets\\img\\Giuj3FT.png"</code>下载自：https://i.imgur.com/Giuj3FT.png</p><p>cmd命令行图标<code>"C:\\opt\\data\\assets\\img\\CMD_32px.png"</code>
下载自：
<a href=https://raw.githubusercontent.com/mahoshojoHCG/GithubPageAccessories/master/Terminal/CMD_32px.png>https://raw.githubusercontent.com/mahoshojoHCG/GithubPageAccessories/master/Terminal/CMD_32px.png</a></p><p>参考：https://github.com/mahoshojoHCG/GithubPageAccessories/tree/master/Terminal</p><p>基本的配置例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-json data-lang=json><span class=err>//</span> <span class=err>This</span> <span class=err>file</span> <span class=err>was</span> <span class=err>initially</span> <span class=err>generated</span> <span class=err>by</span> <span class=err>Windows</span> <span class=err>Terminal</span> <span class=mf>1.3</span><span class=err>.</span><span class=mf>2651.0</span>
<span class=err>//</span> <span class=err>It</span> <span class=err>should</span> <span class=err>still</span> <span class=err>be</span> <span class=err>usable</span> <span class=err>in</span> <span class=err>newer</span> <span class=err>versions,</span> <span class=err>but</span> <span class=err>newer</span> <span class=err>versions</span> <span class=err>might</span> <span class=err>have</span> <span class=err>additional</span>
<span class=err>//</span> <span class=err>settings,</span> <span class=err>help</span> <span class=err>text,</span> <span class=err>or</span> <span class=err>changes</span> <span class=err>that</span> <span class=err>you</span> <span class=err>will</span> <span class=err>not</span> <span class=err>see</span> <span class=err>unless</span> <span class=err>you</span> <span class=err>clear</span> <span class=err>this</span> <span class=err>file</span>
<span class=err>//</span> <span class=err>and</span> <span class=err>let</span> <span class=err>us</span> <span class=err>generate</span> <span class=err>a</span> <span class=err>new</span> <span class=err>one</span> <span class=err>for</span> <span class=err>you.</span>

<span class=err>//</span> <span class=err>To</span> <span class=err>view</span> <span class=err>the</span> <span class=err>default</span> <span class=err>settings,</span> <span class=err>hold</span> <span class=s2>&#34;alt&#34;</span> <span class=err>while</span> <span class=err>clicking</span> <span class=err>on</span> <span class=err>the</span> <span class=s2>&#34;Settings&#34;</span> <span class=err>button.</span>
<span class=err>//</span> <span class=err>For</span> <span class=err>documentation</span> <span class=err>on</span> <span class=err>these</span> <span class=err>settings,</span> <span class=err>see:</span> <span class=err>https://aka.ms/terminal-documentation</span>
<span class=p>{</span>
  <span class=nt>&#34;$schema&#34;</span><span class=p>:</span> <span class=s2>&#34;https://aka.ms/terminal-profiles-schema&#34;</span><span class=p>,</span>

  <span class=nt>&#34;defaultProfile&#34;</span><span class=p>:</span> <span class=s2>&#34;{574e775e-4f2a-5b96-ac1e-a2962a402336}&#34;</span><span class=p>,</span>

  <span class=err>//</span> <span class=err>You</span> <span class=err>can</span> <span class=err>add</span> <span class=err>more</span> <span class=err>global</span> <span class=err>application</span> <span class=err>settings</span> <span class=err>here.</span>
  <span class=err>//</span> <span class=err>To</span> <span class=err>learn</span> <span class=err>more</span> <span class=err>about</span> <span class=err>global</span> <span class=err>settings,</span> <span class=err>visit</span> <span class=err>https://aka.ms/terminal-global-settings</span>

  <span class=err>//</span> <span class=err>If</span> <span class=err>enabled,</span> <span class=err>selections</span> <span class=err>are</span> <span class=err>automatically</span> <span class=err>copied</span> <span class=err>to</span> <span class=err>your</span> <span class=err>clipboard.</span>
  <span class=nt>&#34;copyOnSelect&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>

  <span class=err>//</span> <span class=err>If</span> <span class=err>enabled,</span> <span class=err>formatted</span> <span class=err>data</span> <span class=err>is</span> <span class=err>also</span> <span class=err>copied</span> <span class=err>to</span> <span class=err>your</span> <span class=err>clipboard</span>
  <span class=nt>&#34;copyFormatting&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>

  <span class=err>//</span> <span class=err>A</span> <span class=err>profile</span> <span class=err>specifies</span> <span class=err>a</span> <span class=err>command</span> <span class=err>to</span> <span class=err>execute</span> <span class=err>paired</span> <span class=err>with</span> <span class=err>information</span> <span class=err>about</span> <span class=err>how</span> <span class=err>it</span> <span class=err>should</span> <span class=err>look</span> <span class=err>and</span> <span class=err>feel.</span>
  <span class=err>//</span> <span class=err>Each</span> <span class=err>one</span> <span class=err>of</span> <span class=err>them</span> <span class=err>will</span> <span class=err>appear</span> <span class=err>in</span> <span class=err>the</span> <span class=err>&#39;New</span> <span class=err>Tab&#39;</span> <span class=err>dropdown,</span>
  <span class=err>//</span>   <span class=err>and</span> <span class=err>can</span> <span class=err>be</span> <span class=err>invoked</span> <span class=err>from</span> <span class=err>the</span> <span class=err>commandline</span> <span class=err>with</span> <span class=err>`wt.exe</span> <span class=err>-p</span> <span class=err>xxx`</span>
  <span class=err>//</span> <span class=err>To</span> <span class=err>learn</span> <span class=err>more</span> <span class=err>about</span> <span class=err>profiles,</span> <span class=err>visit</span> <span class=err>https://aka.ms/terminal-profile-settings</span>
  <span class=nt>&#34;profiles&#34;</span><span class=p>:</span> <span class=p>{</span>
    <span class=nt>&#34;defaults&#34;</span><span class=p>:</span> <span class=p>{</span>
      <span class=err>//</span> <span class=err>Put</span> <span class=err>settings</span> <span class=err>here</span> <span class=err>that</span> <span class=err>you</span> <span class=err>want</span> <span class=err>to</span> <span class=err>apply</span> <span class=err>to</span> <span class=err>all</span> <span class=err>profiles.</span>
    <span class=p>},</span>
    <span class=nt>&#34;list&#34;</span><span class=p>:</span> <span class=p>[</span>
      <span class=p>{</span>
        <span class=nt>&#34;guid&#34;</span><span class=p>:</span> <span class=s2>&#34;{574e775e-4f2a-5b96-ac1e-a2962a402336}&#34;</span><span class=p>,</span>
        <span class=nt>&#34;hidden&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;PowerShell&#34;</span><span class=p>,</span>
        <span class=nt>&#34;colorScheme&#34;</span><span class=p>:</span> <span class=s2>&#34;Solarized Dark&#34;</span><span class=p>,</span>
        <span class=nt>&#34;fontFace&#34;</span><span class=p>:</span> <span class=s2>&#34;Sarasa Mono Slab SC&#34;</span><span class=p>,</span>
        <span class=nt>&#34;source&#34;</span><span class=p>:</span> <span class=s2>&#34;Windows.Terminal.PowershellCore&#34;</span>
      <span class=p>},</span>
      <span class=p>{</span>
        <span class=nt>&#34;guid&#34;</span><span class=p>:</span> <span class=s2>&#34;{41dd7a51-f0e1-4420-a2ec-1a7130b7e950}&#34;</span><span class=p>,</span>
        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Windows PowerShell Elevated&#34;</span><span class=p>,</span>
        <span class=nt>&#34;commandline&#34;</span><span class=p>:</span> <span class=s2>&#34;gsudo.exe powershell.exe&#34;</span><span class=p>,</span>
        <span class=nt>&#34;hidden&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
        <span class=nt>&#34;colorScheme&#34;</span><span class=p>:</span> <span class=s2>&#34;Solarized Dark&#34;</span><span class=p>,</span>
        <span class=nt>&#34;fontFace&#34;</span><span class=p>:</span> <span class=s2>&#34;Sarasa Mono Slab SC&#34;</span><span class=p>,</span>
        <span class=nt>&#34;icon&#34;</span><span class=p>:</span> <span class=s2>&#34;C:\\opt\\data\\assets\\img\\Giuj3FT.png&#34;</span>
      <span class=p>},</span>
      <span class=p>{</span>
        <span class=nt>&#34;guid&#34;</span><span class=p>:</span> <span class=s2>&#34;{c6eaf9f4-32a7-5fdc-b5cf-066e8a4b1e40}&#34;</span><span class=p>,</span>
        <span class=nt>&#34;hidden&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Ubuntu-18.04&#34;</span><span class=p>,</span>
        <span class=nt>&#34;source&#34;</span><span class=p>:</span> <span class=s2>&#34;Windows.Terminal.Wsl&#34;</span>
      <span class=p>},</span>
      <span class=p>{</span>
        <span class=err>//</span> <span class=err>Make</span> <span class=err>changes</span> <span class=err>here</span> <span class=err>to</span> <span class=err>the</span> <span class=err>cmd.exe</span> <span class=err>profile.</span>
        <span class=nt>&#34;guid&#34;</span><span class=p>:</span> <span class=s2>&#34;{0caa0dad-35be-5f56-a8ff-afceeeaa6101}&#34;</span><span class=p>,</span>
        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;命令提示符&#34;</span><span class=p>,</span>
        <span class=nt>&#34;commandline&#34;</span><span class=p>:</span> <span class=s2>&#34;cmd.exe&#34;</span><span class=p>,</span>
        <span class=nt>&#34;hidden&#34;</span><span class=p>:</span> <span class=kc>false</span>
      <span class=p>},</span>
      <span class=p>{</span>
        <span class=err>//</span> <span class=err>Make</span> <span class=err>changes</span> <span class=err>here</span> <span class=err>to</span> <span class=err>the</span> <span class=err>cmd.exe</span> <span class=err>profile.</span>
        <span class=nt>&#34;guid&#34;</span><span class=p>:</span> <span class=s2>&#34;{0caa0dad-35be-5f56-a8ff-afceeeaa6102}&#34;</span><span class=p>,</span>
        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;命令提示符(管理员)&#34;</span><span class=p>,</span>
        <span class=nt>&#34;commandline&#34;</span><span class=p>:</span> <span class=s2>&#34;gsudo.exe cmd.exe&#34;</span><span class=p>,</span>
        <span class=nt>&#34;hidden&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
        <span class=nt>&#34;icon&#34;</span><span class=p>:</span> <span class=s2>&#34;C:\\opt\\data\\assets\\img\\CMD_32px.png&#34;</span>
      <span class=p>},</span>
      <span class=p>{</span>
        <span class=err>//</span> <span class=err>Make</span> <span class=err>changes</span> <span class=err>here</span> <span class=err>to</span> <span class=err>the</span> <span class=err>powershell.exe</span> <span class=err>profile.</span>
        <span class=nt>&#34;guid&#34;</span><span class=p>:</span> <span class=s2>&#34;{61c54bbd-c2c6-5271-96e7-009a87ff44bf}&#34;</span><span class=p>,</span>
        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Windows PowerShell&#34;</span><span class=p>,</span>
        <span class=nt>&#34;commandline&#34;</span><span class=p>:</span> <span class=s2>&#34;powershell.exe&#34;</span><span class=p>,</span>
        <span class=nt>&#34;hidden&#34;</span><span class=p>:</span> <span class=kc>false</span>
      <span class=p>},</span>
      <span class=p>{</span>
        <span class=nt>&#34;guid&#34;</span><span class=p>:</span> <span class=s2>&#34;{b453ae62-4e3d-5e58-b989-0a998ec441b8}&#34;</span><span class=p>,</span>
        <span class=nt>&#34;hidden&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Azure Cloud Shell&#34;</span><span class=p>,</span>
        <span class=nt>&#34;source&#34;</span><span class=p>:</span> <span class=s2>&#34;Windows.Terminal.Azure&#34;</span>
      <span class=p>},</span>
      <span class=p>{</span>
        <span class=nt>&#34;guid&#34;</span><span class=p>:</span> <span class=s2>&#34;{574e775e-4f2a-5b96-ac1e-a2962a402336}&#34;</span><span class=p>,</span>
        <span class=nt>&#34;hidden&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;PowerShell&#34;</span><span class=p>,</span>
        <span class=nt>&#34;source&#34;</span><span class=p>:</span> <span class=s2>&#34;Windows.Terminal.PowershellCore&#34;</span>
      <span class=p>},</span>
      <span class=p>{</span>
        <span class=nt>&#34;guid&#34;</span><span class=p>:</span> <span class=s2>&#34;{c6eaf9f4-32a7-5fdc-b5cf-066e8a4b1e40}&#34;</span><span class=p>,</span>
        <span class=nt>&#34;hidden&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Ubuntu-18.04&#34;</span><span class=p>,</span>
        <span class=nt>&#34;source&#34;</span><span class=p>:</span> <span class=s2>&#34;Windows.Terminal.Wsl&#34;</span>
      <span class=p>}</span>
    <span class=p>]</span>
  <span class=p>},</span>

  <span class=err>//</span> <span class=err>Add</span> <span class=err>custom</span> <span class=err>color</span> <span class=err>schemes</span> <span class=err>to</span> <span class=err>this</span> <span class=err>array.</span>
  <span class=err>//</span> <span class=err>To</span> <span class=err>learn</span> <span class=err>more</span> <span class=err>about</span> <span class=err>color</span> <span class=err>schemes,</span> <span class=err>visit</span> <span class=err>https://aka.ms/terminal-color-schemes</span>
  <span class=nt>&#34;schemes&#34;</span><span class=p>:</span> <span class=p>[],</span>

  <span class=err>//</span> <span class=err>Add</span> <span class=err>custom</span> <span class=err>actions</span> <span class=err>and</span> <span class=err>keybindings</span> <span class=err>to</span> <span class=err>this</span> <span class=err>array.</span>
  <span class=err>//</span> <span class=err>To</span> <span class=err>unbind</span> <span class=err>a</span> <span class=err>key</span> <span class=err>combination</span> <span class=err>from</span> <span class=err>your</span> <span class=err>defaults.json,</span> <span class=err>set</span> <span class=err>the</span> <span class=err>command</span> <span class=err>to</span> <span class=nt>&#34;unbound&#34;</span><span class=err>.</span>
  <span class=err>//</span> <span class=err>To</span> <span class=err>learn</span> <span class=err>more</span> <span class=err>about</span> <span class=err>actions</span> <span class=err>and</span> <span class=err>keybindings</span><span class=p>,</span> <span class=err>visit</span> <span class=err>https://aka.ms/terminal-keybindings</span>
  <span class=nt>&#34;actions&#34;</span><span class=p>:</span> <span class=p>[</span>
    <span class=err>//</span> <span class=err>Copy</span> <span class=err>and</span> <span class=err>paste</span> <span class=err>are</span> <span class=err>bound</span> <span class=err>to</span> <span class=err>Ctrl+Shift+C</span> <span class=err>and</span> <span class=err>Ctrl+Shift+V</span> <span class=err>in</span> <span class=err>your</span> <span class=err>defaults.json.</span>
    <span class=err>//</span> <span class=err>These</span> <span class=err>two</span> <span class=err>lines</span> <span class=err>additionally</span> <span class=err>bind</span> <span class=err>them</span> <span class=err>to</span> <span class=err>Ctrl+C</span> <span class=err>and</span> <span class=err>Ctrl+V.</span>
    <span class=err>//</span> <span class=err>To</span> <span class=err>learn</span> <span class=err>more</span> <span class=err>about</span> <span class=err>selection</span><span class=p>,</span> <span class=err>visit</span> <span class=err>https://aka.ms/terminal-selection</span>
    <span class=p>{</span> <span class=nt>&#34;command&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;action&#34;</span><span class=p>:</span> <span class=s2>&#34;copy&#34;</span><span class=p>,</span> <span class=nt>&#34;singleLine&#34;</span><span class=p>:</span> <span class=kc>false</span> <span class=p>},</span> <span class=nt>&#34;keys&#34;</span><span class=p>:</span> <span class=s2>&#34;ctrl+c&#34;</span> <span class=p>},</span>
    <span class=p>{</span> <span class=nt>&#34;command&#34;</span><span class=p>:</span> <span class=s2>&#34;paste&#34;</span><span class=p>,</span> <span class=nt>&#34;keys&#34;</span><span class=p>:</span> <span class=s2>&#34;ctrl+v&#34;</span> <span class=p>},</span>

    <span class=err>//</span> <span class=err>Press</span> <span class=err>Ctrl+Shift+F</span> <span class=err>to</span> <span class=err>open</span> <span class=err>the</span> <span class=err>search</span> <span class=err>box</span>
    <span class=p>{</span> <span class=nt>&#34;command&#34;</span><span class=p>:</span> <span class=s2>&#34;find&#34;</span><span class=p>,</span> <span class=nt>&#34;keys&#34;</span><span class=p>:</span> <span class=s2>&#34;ctrl+shift+f&#34;</span> <span class=p>},</span>

    <span class=err>//</span> <span class=err>Press</span> <span class=err>Alt+Shift+D</span> <span class=err>to</span> <span class=err>open</span> <span class=err>a</span> <span class=err>new</span> <span class=err>pane.</span>
    <span class=err>//</span> <span class=err>-</span> <span class=s2>&#34;split&#34;</span><span class=err>:</span> <span class=s2>&#34;auto&#34;</span> <span class=err>makes</span> <span class=err>this</span> <span class=err>pane</span> <span class=err>open</span> <span class=err>in</span> <span class=err>the</span> <span class=err>direction</span> <span class=err>that</span> <span class=err>provides</span> <span class=err>the</span> <span class=err>most</span> <span class=err>surface</span> <span class=err>area.</span>
    <span class=err>//</span> <span class=err>-</span> <span class=s2>&#34;splitMode&#34;</span><span class=err>:</span> <span class=s2>&#34;duplicate&#34;</span> <span class=err>makes</span> <span class=err>the</span> <span class=err>new</span> <span class=err>pane</span> <span class=err>use</span> <span class=err>the</span> <span class=err>focused</span> <span class=err>pane&#39;s</span> <span class=err>profile.</span>
    <span class=err>//</span> <span class=err>To</span> <span class=err>learn</span> <span class=err>more</span> <span class=err>about</span> <span class=err>panes</span><span class=p>,</span> <span class=err>visit</span> <span class=err>https://aka.ms/terminal-panes</span>
    <span class=p>{</span>
      <span class=nt>&#34;command&#34;</span><span class=p>:</span> <span class=p>{</span>
        <span class=nt>&#34;action&#34;</span><span class=p>:</span> <span class=s2>&#34;splitPane&#34;</span><span class=p>,</span>
        <span class=nt>&#34;split&#34;</span><span class=p>:</span> <span class=s2>&#34;auto&#34;</span><span class=p>,</span>
        <span class=nt>&#34;splitMode&#34;</span><span class=p>:</span> <span class=s2>&#34;duplicate&#34;</span>
      <span class=p>},</span>
      <span class=nt>&#34;keys&#34;</span><span class=p>:</span> <span class=s2>&#34;alt+shift+d&#34;</span>
    <span class=p>}</span>
  <span class=p>]</span>
<span class=p>}</span>

</code></pre></td></tr></table></div></div><p>配置完成后默认第二项“Windows PowerShell Elevated”即为管理员权限的PowerShell终端不需要右键再选择windows terminal图标手工执行了。</p><p><strong>美化windows terminal/powershell</strong></p><p>参考：https://github.com/JanDeDobbeleer/oh-my-posh#installation</p><p>参考：https://hcg.today/2019/08/02/windows-terminal/</p><p>参考：https://sspai.com/post/52868</p><p>参考：https://www.cnblogs.com/kasnti/p/12547985.html</p><p>参考：https://coolcode.org/2018/03/16/how-to-make-your-powershell-beautiful/</p><p>安装字体</p><p>参考：https://github.com/microsoft/cascadia-code/releases</p><p>参考：https://github.com/be5invis/Sarasa-Gothic</p><p>国内镜像：https://mirrors.tuna.tsinghua.edu.cn/github-release/be5invis/Sarasa-Gothic/</p><blockquote><p>下载解压安装更纱黑体之后，我们重新启动一个 PowerShell 终端，就可以在菜单栏右键，选择「属性-字体」，并在字体中选择更纱黑体。适合终端使用的等宽字体是「等距更纱黑体 T SC」或「Sarasa Mono T SC」。</p></blockquote><p>安装colortool</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>scoop</span> <span class=n>install</span> <span class=n>colortool</span>
<span class=c>#colortool -s</span>
<span class=c>#colortool -d OneHalfDark</span>
</code></pre></td></tr></table></div></div><p>安装：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>mkdir</span> <span class=p>~\</span><span class=n>dir_colors</span>
<span class=nb>Set-PSRepository</span> <span class=n>-Name</span> <span class=n>PSGallery</span> <span class=n>-InstallationPolicy</span> <span class=n>Trusted</span>
<span class=nb>Set-ExecutionPolicy</span> <span class=n>-Scope</span> <span class=n>CurrentUser</span> <span class=n>Bypass</span>
<span class=nb>Install-Module</span> <span class=n>windows-screenfetch</span> <span class=n>-Scope</span> <span class=n>CurrentUser</span> <span class=n>-AllowClobber</span>
<span class=nb>Install-Module</span> <span class=n>PSColor</span> <span class=n>-Scope</span> <span class=n>CurrentUser</span>
<span class=nb>Install-Module</span> <span class=n>DirColors</span> <span class=n>-Scope</span> <span class=n>CurrentUser</span>
<span class=nb>Install-Module</span> <span class=n>posh-git</span> <span class=n>-Scope</span> <span class=n>CurrentUser</span>
<span class=nb>Install-Module</span> <span class=n>oh-my-posh</span> <span class=n>-Scope</span> <span class=n>CurrentUser</span>
<span class=nb>Set-Prompt</span>
<span class=nb>Set-Theme</span> <span class=n>Agnoster</span>
<span class=nb>Install-Module</span> <span class=n>-Name</span> <span class=n>PSReadLine</span> <span class=n>-AllowPrerelease</span> <span class=n>-Scope</span> <span class=n>CurrentUser</span> <span class=n>-Force</span> <span class=n>-SkipPublisherCheck</span>
</code></pre></td></tr></table></div></div><p>编辑当前用户的powershell默认启动配置：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=k>if</span> <span class=p>(!(</span><span class=nb>Test-Path</span> <span class=n>-Path</span> <span class=nv>$PROFILE</span> <span class=p>))</span> <span class=p>{</span> <span class=nb>New-Item</span> <span class=n>-Type</span> <span class=n>File</span> <span class=n>-Path</span> <span class=nv>$PROFILE</span> <span class=n>-Force</span> <span class=p>}</span>
<span class=n>notepad</span> <span class=nv>$PROFILE</span>
</code></pre></td></tr></table></div></div><p>在弹出的notepad记事本中粘贴内容：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=c>#Import-Module DirColors</span>
<span class=c>#Update-DirColors ~/dircolors</span>
<span class=nb>Set-Alias</span> <span class=n>edit</span> <span class=n>notepad</span>
<span class=nb>Import-Module</span> <span class=n>posh-git</span>
<span class=c>#if (!(Get-SshAgent)) {</span>
<span class=c>#    Start-SshAgent</span>
<span class=c>#}</span>
<span class=nb>Import-Module</span> <span class=n>oh-my-posh</span>
<span class=nb>Set-Theme</span> <span class=n>Paradox</span>
</code></pre></td></tr></table></div></div><h3 id=配置powershell支持命令行代理>配置powershell支持命令行代理</h3><p>参考：
<a href=https://zcdll.github.io/2018/01/27/proxy-on-windows-terminal/>https://zcdll.github.io/2018/01/27/proxy-on-windows-terminal/</a></p><p>编辑当前用户的powershell默认启动配置：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=k>if</span> <span class=p>(!(</span><span class=nb>Test-Path</span> <span class=n>-Path</span> <span class=nv>$PROFILE</span> <span class=p>))</span> <span class=p>{</span> <span class=nb>New-Item</span> <span class=n>-Type</span> <span class=n>File</span> <span class=n>-Path</span> <span class=nv>$PROFILE</span> <span class=n>-Force</span> <span class=p>}</span>
<span class=n>notepad</span> <span class=nv>$PROFILE</span>
</code></pre></td></tr></table></div></div><p>在弹出的notepad记事本中追加粘贴内容：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=c># NOTE: registry keys for IE 8, may vary for other versions</span>
<span class=nv>$regPath</span> <span class=p>=</span> <span class=s1>&#39;HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings&#39;</span>

<span class=k>function</span> <span class=nb>Clear-Proxy</span>
<span class=p>{</span>
    <span class=nb>Set-ItemProperty</span> <span class=n>-Path</span> <span class=nv>$regPath</span> <span class=n>-Name</span> <span class=n>ProxyEnable</span> <span class=n>-Value</span> <span class=n>0</span>
    <span class=nb>Set-ItemProperty</span> <span class=n>-Path</span> <span class=nv>$regPath</span> <span class=n>-Name</span> <span class=n>ProxyServer</span> <span class=n>-Value</span> <span class=s1>&#39;&#39;</span>
    <span class=nb>Set-ItemProperty</span> <span class=n>-Path</span> <span class=nv>$regPath</span> <span class=n>-Name</span> <span class=n>ProxyOverride</span> <span class=n>-Value</span> <span class=s1>&#39;&#39;</span>

    <span class=no>[Environment]</span><span class=p>::</span><span class=n>SetEnvironmentVariable</span><span class=p>(</span><span class=s1>&#39;http_proxy&#39;</span><span class=p>,</span> <span class=nv>$null</span><span class=p>,</span> <span class=s1>&#39;User&#39;</span><span class=p>)</span>
    <span class=no>[Environment]</span><span class=p>::</span><span class=n>SetEnvironmentVariable</span><span class=p>(</span><span class=s1>&#39;https_proxy&#39;</span><span class=p>,</span> <span class=nv>$null</span><span class=p>,</span> <span class=s1>&#39;User&#39;</span><span class=p>)</span>
<span class=p>}</span>

<span class=k>function</span> <span class=nb>Set-Proxy</span>
<span class=p>{</span>
    <span class=nv>$proxy</span> <span class=p>=</span> <span class=s1>&#39;http://example.com&#39;</span>

    <span class=nb>Set-ItemProperty</span> <span class=n>-Path</span> <span class=nv>$regPath</span> <span class=n>-Name</span> <span class=n>ProxyEnable</span> <span class=n>-Value</span> <span class=n>1</span>
    <span class=nb>Set-ItemProperty</span> <span class=n>-Path</span> <span class=nv>$regPath</span> <span class=n>-Name</span> <span class=n>ProxyServer</span> <span class=n>-Value</span> <span class=nv>$proxy</span>
    <span class=nb>Set-ItemProperty</span> <span class=n>-Path</span> <span class=nv>$regPath</span> <span class=n>-Name</span> <span class=n>ProxyOverride</span> <span class=n>-Value</span> <span class=s1>&#39;&lt;local&gt;&#39;</span>

    <span class=no>[Environment]</span><span class=p>::</span><span class=n>SetEnvironmentVariable</span><span class=p>(</span><span class=s1>&#39;http_proxy&#39;</span><span class=p>,</span> <span class=nv>$proxy</span><span class=p>,</span> <span class=s1>&#39;User&#39;</span><span class=p>)</span>
    <span class=no>[Environment]</span><span class=p>::</span><span class=n>SetEnvironmentVariable</span><span class=p>(</span><span class=s1>&#39;https_proxy&#39;</span><span class=p>,</span> <span class=nv>$proxy</span><span class=p>,</span> <span class=s1>&#39;User&#39;</span><span class=p>)</span>
<span class=p>}</span>

</code></pre></td></tr></table></div></div><p>其中<code>http://example.com</code>替换为你本地http代理的地址比如：<code>http://127.0.0.1:1080</code></p><p>验证：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=nb>Invoke-WebRequest</span> <span class=n>-URI</span> <span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=n>httpbin</span><span class=p>.</span><span class=n>org</span><span class=p>/</span><span class=n>ip</span>
</code></pre></td></tr></table></div></div><h3 id=配置wsl磁盘挂载问题>配置WSL磁盘挂载问题</h3><p>参考：https://p3terx.com/archives/problems-and-solutions-encountered-in-wsl-use-2.html</p><p>windows terminal打开Ubuntu-18.04标签页</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>sudo nano /etc/wsl.conf
</code></pre></td></tr></table></div></div><p>粘贴内容：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>enabled = true
root = /mnt/
options = &#34;metadata,umask=22,fmask=111&#34;
mountFsTab = true
C:\ /mnt/c drvfs rw,noatime,uid=1000,gid=1000,metadata,umask=22,fmask=11 0 0

</code></pre></td></tr></table></div></div><h3 id=windows本地环境与wsl环境问题>windows本地环境与wsl环境问题</h3><p>参考： <a href=https://zhuanlan.zhihu.com/p/237941890>https://zhuanlan.zhihu.com/p/237941890</a></p><p>WSL访问windows环境：
通过上面的drvfs的方式，挂载win下的磁盘分区到/mnt路径下，不过wsl2的访问win的性能比较差</p><p>windows环境访问WSL：</p><p>整体磁盘分区挂载方式：
目前而言需要Windows 10 Insider Preview Build 20211版本才能通过wsl &ndash;mount 挂载物理磁盘
而且还有概率会碰到ubuntu系统下的rpc服务的问题 <a href=https://github.com/microsoft/WSL/issues/5915>https://github.com/microsoft/WSL/issues/5915</a></p><p>走网络磁盘映射方式：
系统默认会提供\wsl$的入口，比如我们上面安装的Ubuntu 18.04 那么整个发行版的访问路径就是</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>\\wsl$\Ubuntu-18.04
</code></pre></td></tr></table></div></div><p>然后用资源管理器打开<code>\\wsl$</code>后可以右键Ubuntu-18.04文件夹将其映射为网络驱动器，比如U:盘。</p><p>普通的映射有个问题是并非Administrator权限
参考：https://cnzhx.net/blog/install-app-into-mapped-network-drive-in-windows-10/</p><p>新建这个wsl_startup.bat批处理文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bat data-lang=bat><span class=p>@</span><span class=k>echo</span> off
<span class=c1>rem net use u: /delete</span>
net use u: \\wsl$\Ubuntu-18.04 /persistent:yes
</code></pre></td></tr></table></div></div><p>将上面的批处理添加到“任务计划程序”
win开始，输入“任务计划程序”打开
任务计划程序（本地）>任务计划程序库>右键“创建基本任务”：
名称：wsl_startup
触发器：计算机启动时
操作：启动程序
程序或脚本，选择上面创建的wsl_startup.bat文件
完成
在右侧的列表中找到wsl_startup项，右键>属性
安全选项中选中：不管用户是否登录都要运行
勾选中使用最高权限运行
确定设置完成</p><p>打开注册表编辑器找到路径：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
</code></pre></td></tr></table></div></div><p>新建修改DWORD类型键值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>EnableLinkedConnections
</code></pre></td></tr></table></div></div><p>值为1</p><p>如果win10是家庭版非专业版，默认是没有组策略编辑器的，需要通过手工打开</p><p>编辑一个批处理比如enable_gpedit.bat：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bat data-lang=bat><span class=p>@</span><span class=k>echo</span> off
<span class=k>pushd</span> <span class=s2>&#34;</span><span class=nv>%~dp0</span><span class=s2>&#34;</span>
<span class=k>dir</span> /b C:\Windows\servicing\Packages\Microsoft-Windows-GroupPolicy-ClientExtensions-Package~3*.mum <span class=p>&gt;</span>List.txt
<span class=k>dir</span> /b C:\Windows\servicing\Packages\Microsoft-Windows-GroupPolicy-ClientTools-Package~3*.mum <span class=p>&gt;&gt;</span>List.txt
<span class=k>for</span> <span class=k>/f</span> <span class=se>%%</span>i <span class=k>in</span> <span class=p>(</span><span class=s1>&#39;findstr /i . List.txt 2^&gt;nul&#39;</span><span class=p>)</span> <span class=k>do</span> dism /online /norestart /add-package:<span class=s2>&#34;C:\Windows\servicing\Packages\</span><span class=se>%%</span><span class=s2>i&#34;</span>
<span class=k>pause</span>
</code></pre></td></tr></table></div></div><p>然后在资源管理器中右键<strong>以管理员身份</strong>运行
完成后就可以使用组策略编辑器了
接着我们需要允许当前用户使用mklink创建软链接
参考：https://blog.csdn.net/SharkMarine/article/details/88538995</p><p>win+r运行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>secpol.msc
</code></pre></td></tr></table></div></div><p>本地策略>用户权限分配>右侧列表中找到“创建符号链接”打开后点击“添加用户或组”，输入当前用户比如user，然后点右侧的检查名称，成功后点确定</p><p>然后重启电脑</p><p>重启后系统会自动挂载wsl的ubuntu18.04发行版实例的磁盘到U:盘分区
同时当前用户也可以通过mklink创建软链接了。</p><p>需要注意的地方：windows的软链接和linux系统的软链接是互相不认识的，所以win下创建的软链接只能windows系统自己用,linux下的亦然。</p><h3 id=代码开发与运行环境>代码开发与运行环境</h3><p>基于目前drvfs访问性能的问题以及在可见的未来ms应该大概率会支持直接访问ext4的磁盘分区，所以目前来说个人觉得更好的方案就是在win10下默认自动挂载wsl的分区到盘符后创建目录软链接，本地IDE直接读取U:盘符或者软链后的目录中的各个项目，运行环境可以在win下安装或者直接使用wsl中的环境运行代码项目。</p></div></div></article><article class="post bg-white"><header class=post-header><h1 class=post-title><a class=post-link href=/post/multi-nodes-continuous-deploy/>多节点持续部署白瞟篇</a></h1><div class=post-meta><time datetime=2020-09-07 class=post-time>2020-09-07</time><div class=post-category><a href=/categories/%E8%BF%90%E7%BB%B4/>运维</a>
<a href=/categories/%E9%83%A8%E7%BD%B2/>部署</a></div></div></header><div class=post-content><div class=post-summary><p>对于中小型项目部署而言，还是尽可能的节省资源，（抠门~~~）
再去自搭个gitlab-ci,或者jenkins去做持续部署就有点大炮打蚊子了。
于是Github Actions 了解一下，整了一下白瞟方案。
基础的知识学习可以去看阮博士的 <a href=https://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html>GitHub Actions 入门教程</a> ，在此不赘述。</p><h2 id=资源>资源</h2><p>网上瞟了一圈，目前比较实用的一些actions有如下：</p><ul><li><a href=https://github.com/Yikun/hub-mirror-action>Hub Mirror Action</a></li></ul><p>github,gitee上都支持私库了代码双份同步他难道不香吗？
<img src=/post/multi-nodes-continuous-deploy/74003fa3757c.jpeg alt=真香></p><ul><li><a href=https://github.com/wearerequired/git-mirror-action>Git Mirror Action</a></li></ul><p>如果你的代码是托管在自搭或其他服务商的平台上的用这个纯ssh协议的镜像actions就对了。</p><ul><li><a href=https://github.com/peaceiris/actions-hugo>GitHub Actions for Hugo</a></li></ul><p>现在已经追求简约风了，hugo的基本功能做博客绰绰有余，用这个再结合<a href=https://github.com/peaceiris/actions-gh-pages>peaceiris/actions-gh-pages</a>基本上github.io的镜像自动发布也一步到位了。</p><ul><li><a href=https://github.com/peaceiris/actions-gh-pages>GitHub Actions for GitHub Pages</a></li></ul><p>自动化发布静态内容到GitHub Pages上形成xxx.github.io的独立站点（有钱买米CNAME一下更可个性化）</p><ul><li><a href=https://github.com/garygrossgarten/github-action-ssh>GitHub Action SSH</a></li></ul><p>基本上在项目的secrets里配好私钥，再结合这个ssh的action可以对你自己的服务器为所欲为
<img src=/post/multi-nodes-continuous-deploy/3078119969.jpg alt=为所欲为></p><h2 id=设计>设计</h2><ul><li><p>代码仓库同步使用 <a href=https://github.com/Yikun/hub-mirror-action>Hub Mirror Action</a> 做github,gitee同步，白瞟目标1达成。</p></li><li><p>github的gh-pages服务直接使用 <a href=https://github.com/peaceiris/actions-hugo>GitHub Actions for Hugo</a> + <a href=https://github.com/peaceiris/actions-gh-pages>GitHub Actions for GitHub Pages</a> 构建即可，白瞟目标2达成。</p></li><li><p>自有vps配好部署公钥后，代码仓库使用<a href=https://github.com/garygrossgarten/github-action-ssh>GitHub Action SSH</a> 做vps本地script/shell指令的执行，白瞟目标3达成。</p></li></ul><h2 id=其他>其他</h2><p>对于国内的服务器而言，用github是会时常撞墙的，所以国内的服务器使用gitee的仓库，但依赖github-acions的回国链路来做部署，不知道何时也会撞墙，
看了一下，貌似gitee这边是支持 <a href=https://gitee.com/help/articles/4285>百度效率云的DevOps的服务</a> 的，所以也可以拿来白瞟，配置过程略复杂，在此不赘述了，有兴趣的可以来捣鼓一下。
用了一下基本上是和阿里云的Pipeline一个套路，装个java的agent到你的vps节点上，然后后台配置脚本内容和路径，基本和jenkins差不多，国内免撞墙自动部署，白瞟目标达成+1。</p><p><img src=/post/multi-nodes-continuous-deploy/201801babies-ops0000.jpg alt=奇怪的技能增加了></p></div></div></article><article class="post bg-white"><header class=post-header><h1 class=post-title><a class=post-link href=/post/setup-iptables-nat/>配置iptables的NAT转发</a></h1><div class=post-meta><time datetime=2020-09-04 class=post-time>2020-09-04</time><div class=post-category><a href=/categories/%E8%BF%90%E7%BB%B4/>运维</a>
<a href=/categories/%E9%85%8D%E7%BD%AE/>配置</a></div></div></header><div class=post-content><div class=post-summary><ol><li>打开系统ip_forward的配置：</li></ol><p>临时：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh><span class=nb>echo</span> <span class=m>1</span> &gt;/proc/sys/net/ipv4/ip_forward
</code></pre></td></tr></table></div></div><p>保持重启有效：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>sudo vim /etc/sysctl.conf
</code></pre></td></tr></table></div></div><p>追加/修改：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>net.ipv4.ip_forward=1
</code></pre></td></tr></table></div></div><p>NAT转发流量：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>-A PREROUTING -p tcp -m tcp --dport 8443 -j DNAT --to-destination 192.168.0.3:81443
-A POSTROUTING -d 192.168.0.3/32 -p tcp -m tcp --dport 81443 -j SNAT --to-source 192.168.0.2
</code></pre></td></tr></table></div></div><p>解释：
前置路由：把对本地网络（比如内网地址为192.168.0.2）8443端口的请求转发给 192.168.0.3的ip地址的81443端口
后置路由：把来自192.168.0.3的ip的81443的请求转发到源ip为192.168.0.2的地址去</p><p>查看结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>sudo iptables -t nat -nvL
</code></pre></td></tr></table></div></div></div></div></article></section><nav class=pagination><ul><li class=active><a href=/>1</a></li><li><a href=/page/2/>2</a></li><li><a href=/page/3/>3</a></li><li><a href=/page/4/>4</a></li><li><a href=/page/5/>5</a></li></ul></nav></div></div></main><footer id=footer class=footer><div class=icon-links><a href=https://twitter.com/nickfan rel="me noopener" class=iconfont title=twitter target=_blank><svg class="icon" viewBox="0 0 1264 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M1229.8616 18.043658s-117.852626 63.135335-164.151872 67.344358c-105.225559-164.151872-505.082682-92.598492-437.738325 223.078185C278.622548 312.675223 89.216542 47.506814 89.216542 47.506814s-117.852626 189.406006 75.762402 345.139833C127.097743 396.85567 55.544363 371.601535 55.544363 371.601535S26.081207 535.753407 253.368414 615.724832c-21.045112 29.463156-113.643603 8.418045-113.643603 8.418045s25.254134 143.10676 231.496229 180.987961c-143.10676 130.479693-387.230056 92.598492-370.393967 105.225559 206.242095 189.406006 1119.599946 231.496229 1128.01799-643.98042C1179.353331 249.539887 1263.533778 123.269217 1263.533778 123.269217s-130.479693 37.881201-138.897738 33.672179C1225.652577 98.015083 1229.8616 18.043658 1229.8616 18.043658"/></svg></a><a href=https://github.com/nickfan rel="me noopener" class=iconfont title=github target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M512 12.672c-282.88.0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667.0-12.16-.426667-44.373333-.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333.0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333.0.0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667.0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72.0 68.522667-.64 123.562667-.64 140.202666.0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"/></svg></a><a href=https://weibo.com/vaxiong rel="me noopener" class=iconfont title=weibo target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M385.714286 733.714286q12-19.428571 6.285714-39.428571t-25.714286-28.571429q-19.428571-8-41.714286-.571429t-34.285714 26.285714q-12.571429 19.428571-7.428571 39.142857t24.571429 28.857143 42.571429 1.428571 35.714286-27.142857zm53.714286-69.142857q4.571429-7.428571 2-15.142857t-10-10.571429q-8-2.857143-16.285714 2.857143t-12.285714 10.571429q-9.714286 17.714286 7.428571 25.714286 8 2.857143 16.571429 2.857143t12.571429-10.571429zm99.428571 61.142857q-25.714286 58.285714-90.285714 85.714286t-128 6.857143q-61.142857-19.428571-84.285714-72.285714t3.714286-107.142857q26.857143-53.142857 86.571429-79.428571t120.285714-10.857143q63.428571 16.571429 90.571429 68.285714t1.428571 108.857143zm178.285714-91.428571q-5.142857-54.857143-50.857143-97.142857t-119.142857-62.285714-156.857143-12q-127.428571 13.142857-211.142857 80.857143t-75.714286 151.142857q5.142857 54.857143 50.857143 97.142857t119.142857 62.285714 156.857143 12q127.428571-13.142857 211.142857-80.857143t75.714286-151.142857zm176 2.285714q0 38.857143-21.142857 79.714286t-62.285714 78.285714-96.285714 67.142857-129.142857 47.428571-154.571429 17.714286-157.142857-19.142857-137.428571-53.142857-98-86.285714-37.142857-114q0-65.714286 39.714286-140t112.857143-147.428571q96.571429-96.571429 195.142857-134.857143t140.857143 4q37.142857 36.571429 11.428571 119.428571-2.285714 8-.571429 11.428571t5.714286 4 8.285714 2.857143 7.714286-2l3.428571-1.142857q79.428571-33.714286 140.571429-33.714286t87.428571 34.857143q25.714286 36 0 101.714286-1.142857 7.428571-2.571429 11.428571t2.571429 7.142857 6.857143 4.285714 9.714286 3.428571q32.571429 10.285714 58.857143 26.857143t45.714286 46.571429 19.428571 66.571429zm-42.285714-356.571429q24 26.857143 31.142857 62t-3.714286 67.142857q-4.571429 13.142857-16.857143 19.428571t-25.428571 2.285714q-13.142857-4.571429-19.428571-16.857143t-2.285714-25.428571q11.428571-36-13.714286-63.428571t-61.142857-20q-13.714286 2.857143-25.714286-4.571429t-14.285714-21.142857q-2.857143-13.714286 4.571429-25.428571t21.142857-14.571429q34.285714-7.428571 68 3.142857t57.714286 37.428571zm103.428571-93.142857q49.714286 54.857143 64.285714 127.142857t-7.714286 138q-5.142857 15.428571-19.428571 22.857143t-29.714286 2.285714-22.857143-19.428571-2.857143-29.714286q16-46.857143 5.714286-98.285714t-45.714286-90.285714q-35.428571-39.428571-84.571429-54.571429t-98.857143-4.857143q-16 3.428571-29.714286-5.428571t-17.142857-24.857143 5.428571-29.428571 24.857143-16.857143q70.285714-14.857143 139.428571 6.571429t118.857143 76.857143z"/></svg></a><a href=https://www.zhihu.com/people/nickfan rel="me noopener" class=iconfont title=zhihu target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M351.791182 562.469462h192.945407c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262h159.282726s-.86367-67.402109-18.578124-67.402109-279.979646.0-279.979646.0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461s24.62791 5.832845 36.941354.0c12.313443-5.832845 68.050885-25.924439 84.252893-103.69571h86.570681c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262H109.86113c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449H279.868105c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513.0.0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-.055259.185218 167.855986 193.263655s22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-.045025.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"/><path d="M584.918753 182.033893v668.840094h70.318532l28.807093 80.512708 121.875768-80.512708h153.600307L959.520453 182.033893H584.918753zM887.150192 778.934538h-79.837326l-99.578949 65.782216-23.537066-65.782216h-24.855084L659.341766 256.673847h227.807403V778.934538z"/></svg></a><a href=https://www.douban.com/people/nickfan81/ rel="me noopener" class=iconfont title=douban target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M926.917973 37.80608C959.65184 37.80608 986.19392 64.34816 986.19392 97.082027V926.917973C986.19392 959.65184 959.65184 986.19392 926.917973 986.19392H97.082027C64.34816 986.19392 37.80608 959.65184 37.80608 926.917973V97.082027C37.80608 64.34816 64.34816 37.80608 97.082027 37.80608zm-750.26432 138.3936V252.678827H825.658027V176.19968zM217.719467 316.146347V628.08064H273.524053L341.292373 770.39616H157.259093V845.417813h685.69088V770.39616H654.226773L722.899627 628.08064H783.67744V316.146347zM684.885333 392.891733V553.987413H312.576V392.891733zM570.770773 770.39616H426.653013L359.621973 628.08064H639.443627z"/></svg></a><a href=https://space.bilibili.com/16584003 rel="me noopener" class=iconfont title=bilibili target=_blank><svg class="icon" viewBox="0 0 1024 1024" width="36" height="36" id="svg8"><path d="M744.60599.00486267A41.779915 41.779915.0 00710.4184 18.673394L548.5048 255.32642h-11.70046a41.779915 41.779915.0 00-10.80295-7.84928L235.66 97.084498a41.779915 41.779915.0 00-20.07193-4.960864 41.779915 41.779915.0 00-18.3748 79.145436L359.4859 255.32642H128.16909c-49.458302.0-89.27932 39.82105-89.27932 89.27932v508.65224c0 49.4583 39.821018 89.27934 89.27932 89.27934h19.48445C149.12802 984.5043 179.92773 1024 224.79179 1024c44.86407.0 75.66379-39.4957 77.13826-81.46268H719.98116C721.45559 984.5043 752.25533 1024 797.1194 1024c44.86406.0 75.6638-39.4957 77.13824-81.46268h21.57323c49.45831.0 89.27936-39.82104 89.27936-89.27934V344.60574c0-49.45827-39.82105-89.27932-89.27936-89.27932H649.74567L779.38103 65.866924A41.779915 41.779915.0 00744.60599.00486267zM644.49108 418.70871c6.29985.21538 12.44451 2.01107 17.86888 5.22196l171.36218 98.10771c18.23417 10.21935 24.63334 33.34627 14.24614 51.48533-10.38726 18.13909-33.57344 24.32718-51.61587 13.77296L624.9903 489.18895c-15.21356-8.41858-22.66871-26.1765-18.03211-42.93436 4.63664-16.75784 20.15573-28.14465 37.53289-27.54588zM350.2006 432.31846c16.89952.0317 31.69582 11.33328 36.17844 27.62747 4.48262 16.2942-2.44981 33.57765-16.95507 42.24898l-140.7157 86.91312c-17.68528 11.18244-41.09629 5.77692-52.08912-12.02686-10.99282-17.80373-5.33855-41.15658 12.58167-51.95857L329.9002 438.2095c6.0643-3.86439 13.10951-5.90891 20.3004-5.89104zM501.605 641.53985c3.75002-.15248 7.48645.53903 10.93349 2.0235.15842.0637.31618.12888.47325.19582.59328.27092 1.17574.56489 1.74609.88121.15868.0854.31643.17233.47325.2611.55694.32165 1.10131.66458 1.63185 1.02807.16455.1123.32777.2265.48956.34269.50382.36781.99371.75428 1.46868 1.15864.18724.15504.37218.31282.55484.47323.43271.38784.8518.79061 1.25653 1.20756.15449.16114.30679.32437.45693.48959.40798.44266.79989.89988 1.17494 1.37076.17799.22544.35205.45395.5222.68538.25932.34701.50964.70071.75064 1.06071.26712.39516.52286.79784.76699 1.20757.16907.29043.33231.58424.48957.88123.21836.41297.42513.83199.62009 1.25653.14836.32333.28983.64976.42429.97911.21319.51552.40915 1.03801.58747 1.5666.0677.19499.13296.39085.19582.58748.18652.60823.34984 1.22334.48957 1.84399.0397.16277.0779.32601.11423.48957.1436.69112.25788 1.38801.34269 2.08877.005.0381.0111.0761.0163.11424.0857.78056.13474 1.56471.14687 2.34988.005.0543.0111.10879.0163.1632.0.0-.008 1.12132.0 1.45234.0.0-.14697 17.84761 5.89102 34.12231 3.01902 8.13734 7.33278 15.10615 12.61433 19.61501 5.28157 4.50889 11.42894 7.62081 23.64572 7.62081 12.2168.0 18.36416-3.11192 23.64573-7.62081 5.28154-4.50886 9.5953-11.47767 12.6143-19.61501 6.03799-16.2747 5.89103-34.12231 5.89103-34.12231-.44885-13.87045 10.45922-25.46302 24.3311-25.86506 13.87189-.40201 25.42828 10.53953 25.78348 24.41272.0.0 1.11929 25.7226-9.00791 53.01927-5.06359 13.64832-13.1986 28.46036-27.05631 40.29073-13.85772 11.83039-33.5454 19.63135-56.20142 19.63135-22.65603.0-42.34371-7.80096-56.20141-19.63135-4.1801-3.56856-7.78733-7.42433-10.99878-11.42303-3.21235 4.00037-6.81703 7.85309-10.99876 11.42303-13.85773 11.83039-33.5454 19.63135-56.20144 19.63135-22.65601.0-42.3437-7.80096-56.2014-19.63135-13.85775-11.83037-21.99272-26.64241-27.05632-40.29073-10.12725-27.29667-9.00789-53.01928-9.00789-53.01927.20714-13.83687 11.58744-24.88848 25.42444-24.69013 14.1263.19991 25.2971 12.0278 24.69011 26.14247.0.0-.14697 17.84761 5.89103 34.12231 3.01902 8.13734 7.31646 15.10615 12.598 19.61501 5.28155 4.50889 11.44526 7.62081 23.66203 7.62081 12.21681.0 18.36418-3.11192 23.64573-7.62081 5.28154-4.50886 9.57899-11.47767 12.598-19.61501 5.76352-15.53489 5.89112-32.05691 5.89103-33.56746.006-.37466.0111-1.05336.0163-1.20759-.0117-.74583.0105-1.49177.0652-2.23565.009-.15784.0204-.31561.0327-.47324.14204-1.56859.43163-3.12027.86487-4.63449.0213-.0763.0433-.15244.0652-.22848 3.0335-10.25748 12.24157-17.46007 22.92769-17.93417z" id="rect824"/></svg></a><a href=/index.xml rel="noopener alternate" type=application/rss+xml class=iconfont title=rss target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><path d="M819.157333 1024C819.157333 574.592 449.408 204.8.0 204.8V0c561.706667.0 1024 462.293333 1024 1024H819.157333zM140.416 743.04a140.8 140.8.0 01140.501333 140.586667A140.928 140.928.0 01140.074667 1024C62.72 1024 0 961.109333.0 883.626667S62.933333 743.082667 140.416 743.04zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352.0 678.784 306.517333 678.784 678.826667z"/></svg></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a></span>
<span class=copyright-year>&copy;
2015 -
2020
<span class=heart><i class=iconfont><svg class="icon" viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14"><path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7.0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1.0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2.0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3.1-42.5-8-83.6-24-122.2z" fill="#8a8a8a"/></svg></i></span><span class=author>axiong</span></span>
<span><a rel=nofollow href=https://beian.miit.gov.cn/ target=_blank>苏ICP备20047619号</a></span></div></footer><div class=back-to-top id=back-to-top><i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="35" height="35"><path d="M510.866688 227.694839 95.449397 629.218702h235.761562L329.15309 958.01517h362.40389L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777h894.052392v131.813095H63.840492V63.962777zm0 0"/></svg></i></div></div><script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin=anonymous></script><script type=text/javascript src=/js/load-photoswipe.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe.min.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe-ui-default.min.js></script></body></html>